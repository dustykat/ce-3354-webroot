
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5. Rainfall-Runoff Relationships &#8212; Spreadsheet Hydrology</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/05-rainfallrunoff/05-rainfallrunoff';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6. Streamflow Measurement and Streamflow Data" href="../06-streamflow/06-streamflow.html" />
    <link rel="prev" title="4. Runoff Generation and Watershed Hydrology" href="../04-runoffgeneration/04-runoffgeneration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/aurora.png" class="logo__image only-light" alt="Spreadsheet Hydrology - Home"/>
    <script>document.write(`<img src="../../_static/aurora.png" class="logo__image only-dark" alt="Spreadsheet Hydrology - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Spreadsheet Hydrology
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00-CLRequirements/00-CLRequirements.html">0. Communication Literacy</a></li>

<li class="toctree-l1"><a class="reference internal" href="../01-introduction/01-introduction.html">1. Introduction</a></li>


<li class="toctree-l1"><a class="reference internal" href="../02-precipitation/02-precipitation.html">2. Precipitation, Hyetographs, Design Storms</a></li>




<li class="toctree-l1"><a class="reference internal" href="../03-infiltration/03-infiltration.html">3. Infiltration, Evaporation, and Soil Moisture</a></li>




<li class="toctree-l1"><a class="reference internal" href="../04-runoffgeneration/04-runoffgeneration.html">4. Runoff Generation and Watershed Hydrology</a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Rainfall-Runoff Relationships</a></li>

<li class="toctree-l1"><a class="reference internal" href="../06-streamflow/06-streamflow.html">6. Streamflow Measurement and Streamflow Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-floodhydrology/07-floodhydrology.html">7. Flood Hydrology and Urban Hydrology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-hydrologicmodels/08-hydrologicmodels.html">8. Hydrologic Modeling</a></li>


<li class="toctree-l1"><a class="reference internal" href="../09-groundwater/09-groundwater.html">9. Groundwater Fundamentals &amp; Flow Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10-wellhydraulics/10-wellhydraulics.html">10. Well Hydraulics &amp; Groundwater Management</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters/05-rainfallrunoff/05-rainfallrunoff.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/05-rainfallrunoff/05-rainfallrunoff.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>5. Rainfall-Runoff Relationships</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">5. Rainfall-Runoff Relationships</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#readings">Readings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#videos">Videos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheets">Spreadsheets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-rational-method-background">The Rational Method - Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rational-method-in-detail">Rational Method - In Detail</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-of-concentration">Time of Concentration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-scs-curve-number-cn-method-background">The SCS Curve Number (CN) Method - Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-number-selection">Curve Number Selection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rainfall-runoff-modeling">Rainfall-Runoff Modeling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-reservoir-model">Linear Reservoir Model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nrcs-runoff-generation-models">NRCS Runoff Generation Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-nrcs-cn-as-a-linear-reservoir-model">Interpretation of NRCS CN as a linear reservoir model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concept-of-hydrograph-peak-s-and-baseflow">Concept of Hydrograph, Peak(s), and Baseflow</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-hydrographs">5.1 Unit Hydrographs</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-unit-hydrograph-assumptions">Principal Unit Hydrograph Assumptions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timing">Timing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-unit-hydrograph-as-a-convolution-kernel">The Unit Hydrograph as a Convolution Kernel</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-formulation">Continuous Formulation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discrete-formulation">Discrete Formulation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#synthetic-vs-observed-unit-hydrographs">Synthetic vs. Observed Unit Hydrographs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observed-unit-hydrographs">Observed Unit Hydrographs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-unit-hydrograph-from-observations">Building a Unit Hydrograph from Observations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#back-substitution">Back-Substitution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares">Least-Squares</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-programming">Linear Programming</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-unit-hydrographs-used-for">What are Unit Hydrographs used for?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-unit-hydrographs">Parametric Unit Hydrographs</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-parametric-unit-hydrographs">Why Use Parametric Unit Hydrographs?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-synthetic-unit-hydrograph">What is a Synthetic Unit Hydrograph?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extending-the-time-base">Extending the Time Base</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synthetic-unit-hydrographs">Synthetic Unit Hydrographs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modified-rational-method">Modified Rational Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modified-rational-method-hydrograph-generator">Modified Rational Method Hydrograph Generator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-s">Exercise(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-end">Section End</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="rainfall-runoff-relationships">
<h1>5. Rainfall-Runoff Relationships<a class="headerlink" href="#rainfall-runoff-relationships" title="Link to this heading">#</a></h1>
<div class="admonition-course-website admonition">
<p class="admonition-title">Course Website</p>
<p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/">Link to Course Webroot</a></p>
</div>
<p>Rainfall–runoff relationships are used as mathematical representations of how a watershed or drainage basin converts precipitation into runoff. It translates <strong>rainfall inputs</strong>—typically visualized as a hyetograph—into <strong>runoff outputs</strong>, shown as a <strong>hydrograph</strong>. This transformation is governed by physical and empirical processes that dictate how water moves through the landscape.</p>
<p>At its core, rainfall–runoff modeling seeks to answer:</p>
<blockquote>
<div><p>“Given a certain rainfall event, how much of that water will appear as flow at the outlet of the watershed—and when?”</p>
</div></blockquote>
<p><strong>Basic Conceptual Flow</strong></p>
<p><img alt="" src="../../_images/RainfallRunoffImage.png" /></p>
<ol class="arabic simple">
<li><p><strong>Rainfall enters</strong> the watershed as a time-varying signal.</p></li>
<li><p><strong>Losses</strong> occur, reducing the portion of rainfall available for runoff:</p></li>
</ol>
<ul class="simple">
<li><p>Infiltration into the soil</p></li>
<li><p>Interception by vegetation or structures</p></li>
<li><p>Evapotranspiration</p></li>
<li><p>Storage in depressions, wetlands, or ponds</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>The remainder becomes <strong>excess rainfall</strong>, which supplies:</p></li>
</ol>
<ul class="simple">
<li><p>Overland flow</p></li>
<li><p>Interflow</p></li>
<li><p>Baseflow</p></li>
</ul>
<p>Together, these pathways determine the shape and magnitude of the runoff hydrograph.</p>
<p><strong>Modeling Approaches</strong>
Rainfall–runoff models can be categorized based on complexity and intended use:</p>
<ul class="simple">
<li><p>Empirical models, like the <strong>Rational Method</strong> and <strong>SCS Curve Number Method</strong>, use simplified assumptions and historical data to estimate peak discharge or runoff volume.</p></li>
<li><p><strong>Conceptual models</strong> treat the watershed as a system of interconnected storages and fluxes.</p></li>
<li><p><strong>Physically-based models</strong> solve conservation equations (mass, momentum) across discretized terrain, but require detailed data and high computational effort.</p></li>
</ul>
<p><strong>Engineering Importance</strong>
Understanding rainfall–runoff relationships are essential for:</p>
<ul class="simple">
<li><p>Designing stormwater infrastructure (culverts, channels, detention basins)</p></li>
<li><p>Predicting flood peaks and volumes</p></li>
<li><p>Managing water supply and drought impacts</p></li>
<li><p>Evaluating land use changes on watershed response</p></li>
</ul>
<section id="readings">
<h2>Readings<a class="headerlink" href="#readings" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://www.waveland.com/browse.php?t=384">Gupta, R.S., 2017. Hydrology and Hydraulic Systems, pp. 711-734</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/3-Readings/CMM1988/Applied%20Hydrology%20VT%20Chow%201988.pdf">Chow, V.T., Maidment, D.R., Mays, L.W., 1988, Applied Hydrology:  New York, McGraw-Hill. pp. 496-507</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/kuichling89-c.pdf">Kuichling, E. (1889). “The relation between the rainfall and the discharge of sewers in populous areas.” Trans. ASCE, 20(1), 1–56. </a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/smith_and_lee_1984.pdf">Smith, A. A. and K.-B. Lee. 1984. “The Rational Method Revisited.” Canadian Journal of Civil Engineering 11, 854–862.</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webroot-2024/3-Readings/techmrt_0-6070-1.pdf">Cleveland, T.G., Thompson, D.B., and Fang,X. 2011. “Use of the Rational and Modified Rational Method for Hydraulic Design.” Texas Department of Transportation, Research Report 0-6070-1</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/Akan_2002.pdf">A Osman Akan. 2002. Modified rational method for sizing infiltration structures. Canadian Journal of Civil Engineering. 29(4): 539-542.</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/MRM_WAMA1300032h.pdf">Dhakal, N., Fang, X., Cleveland, T.G., Thompson, D.B. 2014 “Modified Rational Unit Hydrograph Method and Applications” Institute of Civil Engineers, Journal of Water Management, WATER-D-13-00032R2</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/3-Readings/RateBasedC/Rate-Based-C-Texas.pdf">Dhakal, N., Fang, X., Asquith, W.H., Cleveland, T.G., Thompson, D.B. 2013, “Rate-Based Estimation of the Runoff Coefficients for Selected Watersheds in Texas” American Society of Civil Engineers, Journal of Hydrologic Engineering, Vol. 18, No. 12, December 1, 2013. © ASCE, ISSN 1084-0699/2013/12-1571-1580</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/fang_2008_1.pdf">Fang, X., Thompson, D.B., Cleveland, T.G., Pradhan, D.E., Malla, R. 2008. “Time of Concentration Estimated Using Watershed Parameters Determined by Automated and Manual Methods” American Society of Civil Engineers, Journal of Irrigation and Drainage Engineering, Vol. 134, No 2, pp 202-211.</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/about-me-webroot/about-me/MyWebPapers/journal_papers/ASCE-JHE-1297/Rate-Based-C-Texas.pdf">Dhakal, N., Fang, X., Asquith, W.H., Cleveland, T.G., Thompson, D.B. 2012 “Rate-based Estimation of the Runoff Coefficients for Selected Watersheds in Texas.” American Society of Civil Engineers, Journal of Hydrologic Engineering doi:10.1061/(ASCE)HE. 1943-5584.0000753 (November 29, 2012) ASCE_Hydrology_1297</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/Volumetric_C_Nirajan2012.pdf">Dhakal, N., Fang, X., Cleveland, T.G., Thompson, D.B.; Asquith, W.H., Marzen, L.J. 2012 “Estimation of Volumetric Runoff Coefficients for Texas Watersheds Using Land-Use and Rainfall-Runoff Data” American Society of Civil Engineers, Journal of Irrigation and Drainage Engineering, Vol. 138, No 1, pp 43-54.</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/1-Lectures-2017/Lecture09.pdf">Cleveland, T. G. (2017) <em>Engineering Hydrology Notes to Accompany CE 3354 (Rational Equation, HEC-HMS)</em>, Department of Civil, Environmental, and Construction Engineering, Whitacre College of Engineering.</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/about-me-webroot/about-me/MyWebPapers/project_reports/0-5822-1/">Subdivision of Texas Watersheds for Hydrologic Modeling</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/3-Readings/RateBasedC/Rate-Based-C-Texas.pdf">Rate-Based Estimation of the Runoff Coefficients for Selected Watersheds in Texas</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/kuichling89-c.pdf">Kuichling, E. (1889). “The relation between the rainfall and the discharge of sewers in populous areas.” Trans. ASCE, 20(1), 1–56. </a></p></li>
<li><p><a class="reference external" href="https://www.ars.usda.gov/research/software/download/?softwareid=8&amp;amp;modecode=80-42-05-10">Small Watershed Hydrology (WinTR-55) (Software)</a></p></li>
</ol>
<!--1. [Subdivision of Texas Watersheds for Hydrologic Modeling](http://54.243.252.9/about-me-webroot/about-me/MyWebPapers/project_reports/0-5822-1/)-->
</section>
<section id="videos">
<h2>Videos<a class="headerlink" href="#videos" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=itaESIKKDcs">Basics of the Rational Method (YouTube)</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=ttTceCBinj4">The Rational Method (YouTube)</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=i7lZWDVJGvI&amp;amp;list=PLQv9IPdrtoKgxLQih9UXNbFqXLeJvKEaz&amp;amp;index=5">Time of Concentration (YouTube)</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=ypvXXe5AO-0">Time of Concentration (YouTube)</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=Pw5BWkyl9dI">Time of Concentration (YouTube)</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=MbTNTqG4d6M">Time of Concentration (YouTube)</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=7SWqkf404o8">Modified Rational Method (YouTube)</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=qL6mNN5iELY">Stormwater Hydrology - Runoff (YouTube) at about 12:00 discusses Modified Rational Method but best to watch whole video</a></p></li>
</ol>
</section>
<section id="spreadsheets">
<h2>Spreadsheets<a class="headerlink" href="#spreadsheets" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/UnitHydrographs/ExampleUH_BackSub1.xls">ExampleUH_BackSub1.xls</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/UnitHydrographs/ExampleUH_BackSub2.xls">ExampleUH_BackSub2.xls</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/UnitHydrographs/ExampleUH_LeastSquares.xls">ExampleUH_LeastSquares.xls</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/UnitHydrographs/ExampleUH_TransferFn.xls">ExampleUH_TransferFn.xls</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/UnitHydrographs/ExtendedBase_DifferentStorm.xls">ExtendedBase_DifferentStorm.xls</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/UnitHydrographs/ExtendedBase.xls">ExtendedBase.xls</a></p></li>
</ol>
</section>
<section id="the-rational-method-background">
<h2>The Rational Method - Background<a class="headerlink" href="#the-rational-method-background" title="Link to this heading">#</a></h2>
<p>The Rational Method is one of the oldest and most widely used techniques in engineering hydrology to estimate peak runoff discharge from small watersheds, particularly in urban environments. It’s valued for its simplicity and direct application in drainage design.</p>
<div class="math notranslate nohighlight">
\[Q_p = C i A\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q_p\)</span> = peak runoff rate (typically in cubic feet per second or cubic meters per second)<br></p></li>
<li><p><span class="math notranslate nohighlight">\(C\)</span> = runoff coefficient (dimensionless)<br></p></li>
<li><p><span class="math notranslate nohighlight">\(i\)</span>= rainfall intensity (in/hr or mm/hr) for a duration equal to the time of concentration<br></p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> = drainage area (acres or hectares)<br></p></li>
</ul>
<p><img alt="" src="../../_images/RationalImage.png" /></p>
<p>Key Applications</p>
<ol class="arabic simple">
<li><p>Sizing storm sewers and culverts</p></li>
<li><p>Designing detention basins for small developments (using Modified Rational Method)</p></li>
<li><p>Estimating peak discharge for roadside ditches</p></li>
</ol>
<p>Assumptions and Limitations</p>
<ol class="arabic simple">
<li><p>Assumes uniform rainfall over the area</p></li>
<li><p>Most appropriate for small watersheds (&lt; 200 acres or ~80 ha)</p></li>
<li><p>The rainfall intensity must correspond to the time of concentration (Tc)</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The rational method is most reliable when used for short-duration, high-intensity storms in urbanized watersheds with impervious surfaces.</p>
</div>
</section>
<section id="rational-method-in-detail">
<h2>Rational Method - In Detail<a class="headerlink" href="#rational-method-in-detail" title="Link to this heading">#</a></h2>
<p>The rational method is probably applied the most often by hydraulic and drainage engineers to estimate design discharges for small drainage areas. These design discharges are used to size a variety of drainage structures for small undeveloped and developed watersheds throughout the United States.</p>
<p>The rational method (Kuichling 1889) is expressed as,</p>
<p><span class="math notranslate nohighlight">\(Q_p = m_0 C_{std} iA \)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q_p\)</span> is peak discharge <strong>at some point where flow is concentrated</strong> (an inlet to a storm sewer, a culvert, an outlet from a small watershed, … )</p></li>
<li><p><span class="math notranslate nohighlight">\(m_0\)</span> is a dimensional conversion factor (<span class="math notranslate nohighlight">\(\frac{1}{360} = 0.00278\)</span> in SI units; <span class="math notranslate nohighlight">\(1.008\)</span> in English units).</p></li>
<li><p><span class="math notranslate nohighlight">\(C_{std}\)</span> is a rational runoff coefficient (dimensionless) determined by the land-use characteristics in the watershed,</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> is drainage area (hectares or acres), and</p></li>
<li><p>i is average intensity of rainfall (<span class="math notranslate nohighlight">\(mm/h\)</span> or <span class="math notranslate nohighlight">\(in/h\)</span>) of a specified frequency (probability) for a duration equal to a characteristic time, <span class="math notranslate nohighlight">\(T_c\)</span>, of the drainage area.</p></li>
</ul>
<p>In the U.S., the customary units for the rational method are cubic feet per second (cfs) for <span class="math notranslate nohighlight">\(Q\)</span>, inches per hour (in/hr) for <span class="math notranslate nohighlight">\(i\)</span>, and acres for <span class="math notranslate nohighlight">\(A\)</span>. To be dimensionally consistent, a conversion factor of 1.0083 should be included to <em>convert</em> acre-inches per hour into cubic feet per second; however, this factor is generally neglected.</p>
<p>In this document, <span class="math notranslate nohighlight">\(C_{std}\)</span> is the standard rational runoff coefficient that relates the ratio of input volume rate <span class="math notranslate nohighlight">\(iA\)</span> to the output volume rate <span class="math notranslate nohighlight">\(Q_p\)</span>.</p>
<p>For development of the rational method, it is assumed that:</p>
<ol class="arabic simple">
<li><p><font color="red"><strong>The discharge concentrates/collects at the point of interest</strong> </font></p></li>
<li><p>The rainfall is uniform over the drainage area,</p></li>
<li><p>The peak rate of runoff can be reflected by the rainfall intensity averaged over a time period equal to the characteristic time3 of the drainage area,</p></li>
<li><p>The relative frequency (probability) of runoff is the same as the relative frequency (probability) of the rainfall used in the equation4,</p></li>
<li><p>The above formula implies that the peak discharge occurs when the entire area is contributing flow to the drainage outlet, that is, the peak flow will occur at the characteristic time Tc after the start of uniform rainfall. A uniform rainfall of a longer duration than Tc will not produce a greater peak flow but will only lengthen the discharge period, and</p></li>
<li><p>All runoff generation processes are incorporated into the runoff coefficient.</p></li>
</ol>
<p>The conceptual runoff generation mechanism is illustrated in the Figure below for a continuous rainfall where discharge at the point of interest (watershed outlet) increases until an equilibrium value is reached where the excess rainfall rate and the discharge per unit area become equal. This figure in particular illustrates the fifth assumption, that is that rainfall over a period longer than <span class="math notranslate nohighlight">\(T_c\)</span> has no effect on the discharge in the rational method model.</p>
<p><img alt="" src="../../_images/RationalMethodConceptualProcess.png" /></p>
<p>For small urban drainage designs, such as storm drains, the rational method is the common method for peak flow estimation in the United States (McPherson, 1969) despite criticism for over-simplified assumptions. The widespread use of the rational method can be explained by its simplicity, entrenchment in practice, extensive coverage in the literature, and lack of comparable simple-to-use alternatives (Haan and others, 1994).</p>
<p>The applicable area (over which the method can be applied) is generally restricted to less than one square mile (e.g. FHWA (1980)), and in urban jurisdictions to areas to less than 20 acres (Poertner, 1974), yet the idea of a runoff coefficient could certainly be extended to large basins</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this context these coefficients are not the same as the rational runoff coefficient, hence the use of the jargon “rational runoff coefficient”).</p>
</div>
<p>From inspection of the equation, it is evident that <span class="math notranslate nohighlight">\(C\)</span> is an expression of proportionality between rainfall intensity and peak discharge (flow rate). The theoretical range of values for <span class="math notranslate nohighlight">\(C\)</span> is between 0 and 1. The typical whole watershed <span class="math notranslate nohighlight">\(C\)</span> values (that is, <span class="math notranslate nohighlight">\(C\)</span> values representing the integrated effects of various surfaces in the watershed and other watershed properties) are listed for different general land-use conditions in various design manuals and textbooks.</p>
<p>An on-line <span class="math notranslate nohighlight">\(Q_p\)</span> calculator has links to one such table.</p>
<ul class="simple">
<li><p><a class="reference external" href="http://54.243.252.9/toolbox/hydrology/RationalUS/RationalUS.html">Rational Equation Model US Customary</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/toolbox/hydrology/RationalSI/RationalSI.html">Rational Equation Model SI</a></p></li>
</ul>
<p>The <a class="reference external" href="https://onlinemanuals.txdot.gov/TxDOTOnlineManuals/TxDOTManuals/hyd/rational_method.htm#i1108707">Texas Hydraulic Design Manual</a> contains a useful discussion on appliciability and use of the Rational Method in drainage design.</p>
<section id="time-of-concentration">
<h3>Time of Concentration<a class="headerlink" href="#time-of-concentration" title="Link to this heading">#</a></h3>
<p>The time of concentration is the crucial element of the Rational Equation (notably actually absent in an explicit sense from the equation).</p>
<ul class="simple">
<li><p>The value of <span class="math notranslate nohighlight">\(T_C\)</span> is important in rational method for estimating rainfall intensity.</p></li>
<li><p>It is also used in many other hydrologic models to quantify the watershed response time.</p></li>
</ul>
<p>Time of concentration <span class="math notranslate nohighlight">\(T_C\)</span> is the time required for an entire watershed to contribute to runoff at the point of interest for hydraulic design. It is calculated as the time for runoff to flow from the most hydraulically remote point of the drainage area to the point under investigation.</p>
<p>Travel time and <span class="math notranslate nohighlight">\(T_C\)</span> are functions of length and velocity for a particular watercourse.</p>
<ul class="simple">
<li><p>A long but steep flow path with a high velocity may actually have a shorter travel time than a short but relatively flat flow path.</p></li>
<li><p>There may be multiple paths to consider in determining the longest travel time.</p></li>
<li><p>The designer must identify the flow path along which the longest travel time is likely to occur.</p></li>
</ul>
<p>Various Methods to Estimate <span class="math notranslate nohighlight">\(T_C\)</span> include:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/3-Readings/CMM1988/">CMM pp. 500-501</a> has several formulas.</p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/3-Readings/FHWAHighwayHydrology/FHWA-NHI-02-001.pdf">HDS-2 pp. 2-21 to 2-31</a> has formulas and examples.</p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/3-Readings/LS1973/linear-systems-hydrology-dooge.pdf">LS pp. 196-198</a> has several formulas.</p></li>
</ul>
<p>Some simple useful methods are examined in</p>
<ul class="simple">
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/1-Lectures-2017/Lecture09.pdf">Cleveland, T. G. (2017) <em>Engineering Hydrology Notes to Accompany CE 3354 (Rational Equation, HEC-HMS)</em>, Department of Civil, Environmental, and Construction Engineering, Whitacre College of Engineering.</a></p></li>
</ul>
<p>The tools referenced in the above document are located below:</p>
<ul class="simple">
<li><p>NRCS Upland (uses the graph pg 720 of Gupta). <a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/NRCS-Upland.xls">NRCS-Upland.xls</a>; <a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/NRCS-Upland.xlsx">NRCS-Upland.xlsx</a></p></li>
<li><p>Kerby-Kirpich <a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/KerbyKirpich-US.xls">Kerby-Kirpich.xls</a>;<a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/KerbyKirpich-US.xlsx">Kerby-Kirpich.xlsx</a></p></li>
<li><p>NRCS Velocity <a class="reference external" href="http://54.243.252.9/ce-3354-webroot/5-Spreadsheets/TXDOT-TIME-OF-CONCENTRATION-NRCS.xlsx">TXDOT-TIME-OF-CONCENTRATION-NRCS.xlsx</a></p></li>
</ul>
</section>
</section>
<section id="the-scs-curve-number-cn-method-background">
<h2>The SCS Curve Number (CN) Method - Background<a class="headerlink" href="#the-scs-curve-number-cn-method-background" title="Link to this heading">#</a></h2>
<p>The Curve Number Method was developed by the U.S. Soil Conservation Service (now NRCS), the Curve Number (CN) Method estimates direct runoff depth from rainfall events using empirical relationships based on land use, soil type, and hydrologic condition. It’s widely used in both rural and urban watershed modeling.</p>
<p>The basic form of the method is:</p>
<div class="math notranslate nohighlight">
\[Q=\frac{(P-I_a)^2}{(P-I_a+S)} \text{    for   } P&gt;I_a \]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q\)</span> = <strong>depth</strong> of direct runoff (in watershed inches or mm)</p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span> = <strong>depth</strong> of precipitation</p></li>
<li><p><span class="math notranslate nohighlight">\(I_a\)</span> = initial abstraction (default is <span class="math notranslate nohighlight">\(0.2 \times S\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> = potential maximum retention (in) <span class="math notranslate nohighlight">\(S = \frac{1000}{CN} - 10\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(CN\)</span> = Curve Number, ranging from 30–100</p></li>
</ul>
<p><img alt="" src="../../_images/CNImage.png" /></p>
<section id="curve-number-selection">
<h3>Curve Number Selection<a class="headerlink" href="#curve-number-selection" title="Link to this heading">#</a></h3>
<p>Curve numbers are determined from tables based on:</p>
<ol class="arabic simple">
<li><p>Land use and cover (e.g., forest, grassland, urban)</p></li>
<li><p>Soil group (A to D, from high to low infiltration capacity)</p></li>
<li><p>Antecedent moisture conditions</p></li>
</ol>
<p>Key Applications</p>
<ol class="arabic simple">
<li><p>Estimating runoff volumes for detention and retention pond sizing</p></li>
<li><p>Used in watershed models like HEC-HMS, TR-55, and SWMM</p></li>
<li><p>Common in floodplain analysis and stormwater permitting</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The CN method is especially useful in moderate to large watersheds where land cover and soils vary across the basin.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="rainfall-runoff-modeling">
<h2>Rainfall-Runoff Modeling<a class="headerlink" href="#rainfall-runoff-modeling" title="Link to this heading">#</a></h2>
<p>A rainfall-runoff model is a mathematical model describing the rainfall–runoff relations of a rainfall catchment area, drainage basin or watershed. It produces a runoff hydrograph in response to rainfall inputs, represented by a hyetograph. In other words, the model calculates the conversion of rainfall into runoff.</p>
<p>In comparatively sophisticated modeling one considers the rainfall signal coming into the watershed, filtered by losses from evapotranspiration, infiltration, any water that is added to storage - what remains is the runoff.</p>
<section id="linear-reservoir-model">
<h3>Linear Reservoir Model<a class="headerlink" href="#linear-reservoir-model" title="Link to this heading">#</a></h3>
<p>As a starting point, consider a linear-reservoir model of the watershed.  Conceptually the linear reservoir model employs the water budget for a watershed, and that discharge from the watershed is proportional to the current accumulated storage.</p>
<p>Starting with something like the sketch below.</p>
<p><img alt="" src="../../_images/linearReservoir.png" /></p>
<p>One relates the discharge formula and the storage formula.  The discharge formula, is where the “linear” part arises (linear in accumulated watershed depth) the constant <span class="math notranslate nohighlight">\(\frac{1}{\alpha}\)</span> is just some property of the watershed; <span class="math notranslate nohighlight">\(\alpha\)</span> is non zero.</p>
<div class="math notranslate nohighlight">
\[Q(t) = \frac{1}{\alpha}~A~\bar h(t)\]</div>
<p>And the storage formula is</p>
<div class="math notranslate nohighlight">
\[P(t)~A - Q(t) = \frac{dS}{dt}\]</div>
<p>with a substitution</p>
<div class="math notranslate nohighlight">
\[P(t)~A - C~A~\bar h(t) = \frac{dS}{dt}\]</div>
<p>Storage itself is simply the product of the accumulated watershed depth and area</p>
<div class="math notranslate nohighlight">
\[S = A~\bar h(t)\]</div>
<p>Another substitution</p>
<div class="math notranslate nohighlight">
\[P(t)~A - \frac{1}{\alpha}~A~\bar h(t) = \frac{dA~\bar h(t)}{dt}\]</div>
<p>Now we can factor out the obvious constants to obtain</p>
<div class="math notranslate nohighlight">
\[A[P(t) - \frac{1}{\alpha}~\bar h(t)] = A~\frac{d~\bar h(t)}{dt}\]</div>
<p>Seperate, integrate, and simplify; we assume that <span class="math notranslate nohighlight">\(P\)</span> is some constant (otherwise the analysis is a bit more complex)</p>
<div class="math notranslate nohighlight">
\[Q = A~\frac{1}{\alpha}~\bar h(t) = A~P(1-e^{-\frac{t}{\alpha}})\]</div>
<p>Now naturally we dont know <span class="math notranslate nohighlight">\(\alpha\)</span> for a watershed, hence the need for data analysis.  Suppose for the sake of demonstration it is 1.0, we can simulate the anticipated discharge for a watershed (in the absence of losses)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># structural simulation need units for practical applications</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#watershed discharge conversion constant</span>
<span class="n">area</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1">#some area</span>
<span class="n">pee</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#constant rain</span>
<span class="n">qzero</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#zero initial discharge</span>
<span class="n">hzero</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#zero initial storage</span>
<span class="n">howmany</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">qnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">pnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">dsnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">deltat</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="c1"># time step value</span>
<span class="n">dsnow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span> <span class="c1"># set first condition at infinty</span>
<span class="k">for</span> <span class="n">itime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">howmany</span><span class="p">):</span>
    <span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span> <span class="o">=</span> <span class="n">deltat</span><span class="o">+</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">qnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">area</span><span class="o">*</span><span class="n">pee</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">/</span><span class="n">alpha</span><span class="p">)))</span>
    <span class="n">pnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">area</span><span class="o">*</span><span class="n">pee</span><span class="p">)</span>
    <span class="n">average_in</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">pnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">+</span><span class="n">pnow</span><span class="p">[</span><span class="n">itime</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">average_out</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">qnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">+</span><span class="n">qnow</span><span class="p">[</span><span class="n">itime</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">dsnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="p">((</span><span class="n">average_in</span><span class="o">-</span><span class="n">average_out</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="c1"># the python plotting library</span>
<span class="n">myfigure</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># generate a object from the figure class, set aspect ratio</span>

<span class="c1"># Built the plot</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">qnow</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">pnow</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dsnow</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Elapsed Time&quot;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Runoff or Rainfall in L^3/T&quot;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Linear Reservoir Runoff Model </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;Area =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">area</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; alpha =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Discharge&quot;</span><span class="p">,</span><span class="s2">&quot;Precipitation&quot;</span><span class="p">,</span><span class="s2">&quot;Delta Storage&quot;</span><span class="p">])</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/33d16d7158800d940cae208760568174e89cf515b4e63b192684d74ac84920b9.png" src="../../_images/33d16d7158800d940cae208760568174e89cf515b4e63b192684d74ac84920b9.png" />
</div>
</div>
<p>A interpretation of this kind of model can serve as an explaination of the NRCS CN method (but in cumulative space)</p>
</section>
</section>
<section id="nrcs-runoff-generation-models">
<h2>NRCS Runoff Generation Models<a class="headerlink" href="#nrcs-runoff-generation-models" title="Link to this heading">#</a></h2>
<p>The CN method is in common use and is examined here.
The curve number approach is based on a volume balance.
The derivation is in the National Engineering Handbook Chapter 10.</p>
<p>The curve number is a solution to:</p>
<div class="math notranslate nohighlight">
\[ 
Q = \frac{(P-0.2S)^2}{P+0.8S}
\]</div>
<p>where <span class="math notranslate nohighlight">\(Q\)</span> is the cumulative runoff (integral of the hydrograph) in watershed depth (i.e. Discharge/Area), P is the cumulative rainfall (integral of the hyetograph). Drainage area is used to make units consistent; either divide Q by area to get a depth, or multiply P by area to get volume). S is the retention (like a storage term).</p>
<p>The curve number, <span class="math notranslate nohighlight">\(CN\)</span>, is simply a transformation of <span class="math notranslate nohighlight">\(S\)</span></p>
<div class="math notranslate nohighlight">
\[CN = \frac{1000}{S+10}\]</div>
<p>The <span class="math notranslate nohighlight">\(CN\)</span> values for a large number of land coverages (hydrologic soil complex coverage number; or runoff curve number) were tabulated by the NRCS many years ago.
It is of note that the method was intended for agricultural use.</p>
<p>Equations similar in structure to the NRCS equations above can be constructed by assuming the watershed operates as a linear reservoir and such an analysis provides some understanding of <span class="math notranslate nohighlight">\(CN\)</span> (as other than just a tabulation). When viewed in such a fashion the <span class="math notranslate nohighlight">\(CN\)</span> is like a response or residence time parameter (<span class="math notranslate nohighlight">\(\alpha\)</span> in our linear reservoir model above) and represents how long in dimensionless time it takes the watershed to reach an equilibrium storage condition where the precipitation that enters leaves.
Large values (90+) are “fast” responding watersheds, small values (50-ish) are “slow” responding watersheds.</p>
<p>The figure below is the typical graphical representation from NRCS sources.</p>
<p><img alt="" src="../../_images/CNchart.png" /></p>
<p>Now lets demonstrate that structurally the <span class="math notranslate nohighlight">\(CN\)</span> model is explainable as a particular interpretation of a linear reservoir model.</p>
<p>Start with linear reservoir model, but include some abstractions.  Show in cumulative space to get CN-type model.</p>
</section>
<section id="interpretation-of-nrcs-cn-as-a-linear-reservoir-model">
<h2>Interpretation of NRCS CN as a linear reservoir model<a class="headerlink" href="#interpretation-of-nrcs-cn-as-a-linear-reservoir-model" title="Link to this heading">#</a></h2>
<p>Assume a watershed can be represented as a linear reservoir, where the discharge is proportional to accumulated storage.
Using the <span class="math notranslate nohighlight">\(CN\)</span> variable names and definitions it is possible to construct a discharge function that is a decaying exponential.
The decay rate conveys similar information as the curve number, that is it relates how much cumulative precipitation must occur before the retention is satisfied and the ratio of actual to potential retention becomes one.</p>
<p>First the variable names associated with the Figure below and their definitions from chapter 10, NEH.</p>
<p><img alt="" src="../../_images/CNReservoir.png" /></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I_a\)</span> is the initial abstraction - it represents input rainfall that never appears as runoff and is removed at the beginning of an event.</p></li>
<li><p><span class="math notranslate nohighlight">\(F_a\)</span> is the watershed retention - it represents the depth of water retained on the watershed after runoff begins.  In our previous model it plays the same role as <span class="math notranslate nohighlight">\(\bar h\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> is the potential watershed retention after runoff begins - it represents the maximum possible depth of of water retained on the watershed if the rain goes on forever.</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> is the actual runoff depth.</p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span> is the actual rainfall depth.</p></li>
</ul>
<p>The figure above is a sketch of a watershed as a reservoir.
The area is <span class="math notranslate nohighlight">\(A\)</span>, precipitation rate is <span class="math notranslate nohighlight">\(i\)</span>, the initial abstraction is <span class="math notranslate nohighlight">\(I_a\)</span> and the actual retention (accumulated depth on the watershed in excess of <span class="math notranslate nohighlight">\(I_a\)</span>) is <span class="math notranslate nohighlight">\(F_a\)</span>.
The discharge in volume units is <span class="math notranslate nohighlight">\(qA\)</span>.
If one writes a mass balance on the watershed in terms of <span class="math notranslate nohighlight">\(F_a\)</span>, <strong>ASSUMING</strong> the initial abstraction is already satisfied (as in the NRCS definition of <span class="math notranslate nohighlight">\(F_a\)</span> above), then the resulting equation is</p>
<div class="math notranslate nohighlight">
\[A~\frac{d F_a}{dt} = A(i -q) \]</div>
<p>Normalizing by the constant watershed area</p>
<div class="math notranslate nohighlight">
\[~\frac{d F_a}{dt} = (i -q) \]</div>
<p>The units of precipitation and discharge are now <span class="math notranslate nohighlight">\(\frac{L}{T}\)</span> (depth per unit time).
The units of <strong>accumulated</strong> depth are length (thus the time derivative is L/T). If we <strong>ASSUME</strong> a linear response, that is the specific discharge is proportional to accumulated depth (<span class="math notranslate nohighlight">\(F_a\)</span>) we can postulate a model for the discharge as</p>
<div class="math notranslate nohighlight">
\[q = \frac{1}{\alpha}F_a \]</div>
<p>The term <span class="math notranslate nohighlight">\(\alpha\)</span> is some non-zero constant that reflects the discharge from the watershed as some proportion of accumulated depth.</p>
<p>Now substitute into the mass balance and solve for <span class="math notranslate nohighlight">\(F_a\)</span> and <strong>ASSUME</strong> that precipitation rate is a constant value one can arrive at:</p>
<div class="math notranslate nohighlight">
\[q = \frac{1}{\alpha}F_a = i(1-e^{-\frac{t}{\alpha}})\]</div>
<p>In this formula time begins when <span class="math notranslate nohighlight">\(I_a\)</span> is satisfied.</p>
<p>Now examine the definitions of <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> (or <span class="math notranslate nohighlight">\(P_e\)</span>) in the NRCS documents. By defintion:</p>
<div class="math notranslate nohighlight">
\[Q = \int_{lb}^{ub}q(\tau)d\tau = it+i \alpha  e^{-\frac{t}{\alpha}} -i \alpha\]</div>
<div class="math notranslate nohighlight">
\[P = it + I_a + F_a\]</div>
<p>Now construct a plot (simulation) that plots <span class="math notranslate nohighlight">\(Q\)</span> versus <span class="math notranslate nohighlight">\(P\)</span> for different values of alpha (plus an equal value line) we have</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># structural simulation need units for practical applications</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">howmany</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#watershed discharge conversion constant</span>
<span class="n">peein</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">abstraction</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">retention</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">maxretention</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="k">def</span> <span class="nf">qfunc</span><span class="p">(</span><span class="n">inflow</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">alpha</span><span class="p">):</span>
    <span class="n">qfunc</span> <span class="o">=</span> <span class="n">inflow</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="n">alpha</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">qfunc</span><span class="p">)</span>

<span class="n">qnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">pnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">rnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">deltat</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="c1"># time step value</span>
<span class="c1"># time zero values</span>
<span class="n">qnow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">peein</span><span class="o">*</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">peein</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">-</span><span class="n">peein</span><span class="o">*</span><span class="n">alpha</span>
<span class="k">for</span> <span class="n">itime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">howmany</span><span class="p">):</span>
    <span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span> <span class="o">=</span> <span class="n">deltat</span><span class="o">+</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">qnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="n">peein</span><span class="o">*</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">+</span><span class="n">peein</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">-</span><span class="n">peein</span><span class="o">*</span><span class="n">alpha</span>
    <span class="n">rnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="n">alpha</span><span class="o">*</span><span class="n">qfunc</span><span class="p">(</span><span class="n">peein</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">],</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">pnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="n">peein</span><span class="o">*</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">+</span><span class="n">abstraction</span><span class="o">+</span><span class="n">rnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span>



<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="c1"># the python plotting library</span>
<span class="n">myfigure</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># generate a object from the figure class, set aspect ratio</span>

<span class="c1"># Built the plot</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnow</span><span class="p">,</span> <span class="n">pnow</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnow</span><span class="p">,</span> <span class="n">qnow</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> 
<span class="c1">#matplotlib.pyplot.plot(time, dsnow, color =&#39;green&#39;) </span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Cumulative Precipitation L&quot;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cumulative Runoff L&quot;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Linear Reservoir Runoff Model </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;Max Retention =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">maxretention</span><span class="p">)</span><span class="o">+</span>
                        <span class="s2">&quot; Initial Abstraction =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">abstraction</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;Precipitation Rate =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">peein</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; alpha =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;alpha &lt; 0.001&quot;</span><span class="p">,</span><span class="s2">&quot;alpha = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span><span class="s2">&quot;Delta Storage&quot;</span><span class="p">])</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1ec108e17c6aaafa43fac0e244be6e2fc7c0d89eeef98949f9005bb85dc52a86.png" src="../../_images/1ec108e17c6aaafa43fac0e244be6e2fc7c0d89eeef98949f9005bb85dc52a86.png" />
</div>
</div>
<p>Now if we compare the appearance of the simulation figure to the NRCS chart we can observe that the charts convey the same kinds of curves, specifically the amount of precipitation accumulation required to produce constant runoff, as well as the conversion ratio between observed cumulative precipitation and observed cumulative runoff. In the case of the linear-reservoir model, the information is conveyed by the parameter <span class="math notranslate nohighlight">\(\alpha\)</span> which dimensionally is a residence time, while the curve number <span class="math notranslate nohighlight">\(CN\)</span> plays a similar role in the NRCS methodology.</p>
<p>A bit more examination and we can conjecture:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\alpha = \frac{100-CN}{10}\)</span> will generate identical looking curves to the NRCS charts</p></li>
<li><p><span class="math notranslate nohighlight">\(i\alpha = S\)</span> thus the product of the residence time and intensity is the maximum potential retention.</p></li>
<li><p>Runoff starts (in the time domain) at <span class="math notranslate nohighlight">\(t_r = I_a = \frac{\alpha}{5}\)</span></p></li>
</ol>
<p>So lets modify the script to reflect this conjecture</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># structural simulation need units for practical applications</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">howmany</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">CN</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">CN</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span> <span class="c1">#watershed discharge conversion constant</span>
<span class="n">peein</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">abstraction</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">retention</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">maxretention</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="k">def</span> <span class="nf">qfunc</span><span class="p">(</span><span class="n">inflow</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">alpha</span><span class="p">):</span>
    <span class="n">qfunc</span> <span class="o">=</span> <span class="n">inflow</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="n">alpha</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">qfunc</span><span class="p">)</span>

<span class="n">qnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">pnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">rnow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">)]</span>
<span class="n">deltat</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="c1"># time step value</span>
<span class="c1"># time zero values</span>
<span class="n">qnow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">peein</span><span class="o">*</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">peein</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">-</span><span class="n">peein</span><span class="o">*</span><span class="n">alpha</span>
<span class="k">for</span> <span class="n">itime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">howmany</span><span class="p">):</span>
    <span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span> <span class="o">=</span> <span class="n">deltat</span><span class="o">+</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">qnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="n">peein</span><span class="o">*</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">+</span><span class="n">peein</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">-</span><span class="n">peein</span><span class="o">*</span><span class="n">alpha</span>
    <span class="n">rnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="n">alpha</span><span class="o">*</span><span class="n">qfunc</span><span class="p">(</span><span class="n">peein</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">],</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">pnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">=</span><span class="n">peein</span><span class="o">*</span><span class="n">time</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span><span class="o">+</span><span class="n">abstraction</span><span class="o">+</span><span class="n">rnow</span><span class="p">[</span><span class="n">itime</span><span class="p">]</span>



<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="c1"># the python plotting library</span>
<span class="n">myfigure</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># generate a object from the figure class, set aspect ratio</span>

<span class="c1"># Built the plot</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnow</span><span class="p">,</span> <span class="n">pnow</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pnow</span><span class="p">,</span> <span class="n">qnow</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> 
<span class="c1">#matplotlib.pyplot.plot(time, dsnow, color =&#39;green&#39;) </span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Cumulative Precipitation L&quot;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cumulative Runoff L&quot;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Linear Reservoir Runoff Model </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;Max Retention =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">maxretention</span><span class="p">)</span><span class="o">+</span>
                        <span class="s2">&quot; Initial Abstraction =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">abstraction</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;Precipitation Rate =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">peein</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; alpha =&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;CN = 100&quot;</span><span class="p">,</span><span class="s2">&quot;CN = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CN</span><span class="p">),</span><span class="s2">&quot;Delta Storage&quot;</span><span class="p">])</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c0e643842813e3fd698344fc8198380be8a3d51bc929dc2d3c0afcd743f75305.png" src="../../_images/c0e643842813e3fd698344fc8198380be8a3d51bc929dc2d3c0afcd743f75305.png" />
</div>
</div>
<p>so in practice we don’t use the <span class="math notranslate nohighlight">\(CN\)</span> model as a linear reservoir. It is strictly treated as a runoff generation procedure - its useful and practical, but is built on limited assumptions.</p>
<p>The <span class="math notranslate nohighlight">\(CN\)</span> values are tabulated in many locations including:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://websoilsurvey.sc.egov.usda.gov/App/HomePage.htm">WSS</a>  After an AOI is delineated, the soils property tab will return CN values associated with each soil texture.</p></li>
<li><p><a class="reference external" href="https://directives.sc.egov.usda.gov/OpenNonWebContent.aspx?content=17758.wba">NEH Chapter 9</a> Tables of CN for different soil textures</p></li>
<li><p><a class="reference external" href="http://onlinemanuals.txdot.gov/txdotmanuals/hyd/hydrograph_method.htm#JSGEGKGG">Texas HDM</a> Similar to above, with some probability and geographic corrections.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <span class="math notranslate nohighlight">\(CN\)</span> method using composite curve numbers is one of the suggested methods to consider in the Hardin Creek design/analysis project.  While by no means the bestest, its not bad for the application and relatively easy to parameterize and is built-in to HEC-HMS the design/analysis tool you will use.</p>
</div>
</section>
<section id="concept-of-hydrograph-peak-s-and-baseflow">
<h2>Concept of Hydrograph, Peak(s), and Baseflow<a class="headerlink" href="#concept-of-hydrograph-peak-s-and-baseflow" title="Link to this heading">#</a></h2>
<p>A hydrograph is a time series plot that shows how streamflow or discharge varies over time at a particular point in a watershed, typically following a rainfall event. It reflects the integrated response of a watershed to precipitation, modulated by surface and subsurface flow processes.</p>
<p><img alt="" src="../../_images/hydrograph-1.png" /></p>
<p>The idealized hydrograph is divided into:</p>
<ul class="simple">
<li><p>Rising limb: where discharge increases rapidly due to incoming runoff</p></li>
<li><p>Peak flow: the highest point of the hydrograph, representing the maximum discharge</p></li>
<li><p>Recession limb: the gradual decrease in flow as runoff and baseflow subside</p></li>
</ul>
<p>In engineering hydrology, <strong>peak flow</strong> estimation is essential for:</p>
<ol class="arabic simple">
<li><p>Designing culverts, bridges, detention ponds</p></li>
<li><p>Urban drainage systems</p></li>
<li><p>Flood risk assessments</p></li>
</ol>
<p>In engineering hydrology, entire <strong>hydrograph estimation</strong> is important for</p>
<ol class="arabic simple">
<li><p>Modeling the temporal distribution of runoff for detention and retention system design</p></li>
<li><p>Assessing watershed response for hydrologic and hydraulic simulation models</p></li>
<li><p>Supporting water quality analysis and long-term water resource planning</p></li>
</ol>
<p>The hydrograph pictured also has a baseflow component
– Flow in the absence of a storm, often contributed by groundwater discharge or delayed interflow.
– During storm events, total streamflow consists of both baseflow and stormflow (direct runoff) components.
– To estimate peak flow or the entire storm hydrograph, it is important to separate the baseflow from the observed hydrograph.
– This separation is essential for understanding rainfall-runoff relationships and for use in modeling, design, and watershed assessments.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The hydrographs shown in this chapter assume that baseflow separation has already been completed. That means the flow values plotted and analyzed represent only the storm-related (direct) runoff, not the total streamflow at the gage. In technical terms, these are direct runoff hydrographs.</p>
<p>In real-world applications, observed streamflow is a combination of baseflow (groundwater contribution) and direct runoff (from precipitation events). Removing baseflow is an essential step when estimating watershed response, runoff volume, or peak flow from rainfall events.</p>
<p>The methods used to perform this baseflow separation—whether graphical or computational—are not covered here. You will learn these techniques in the next chapter, where we examine several standard approaches and their implications on hydrograph interpretation.</p>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="unit-hydrographs">
<h1>5.1 Unit Hydrographs<a class="headerlink" href="#unit-hydrographs" title="Link to this heading">#</a></h1>
<p>A Unit Hydrograph (UH) is a special type of hydrograph function that represents the response (in discharge) of a watershed to 1 inch (or 1 mm) of effective rainfall uniformly distributed over the basin for a specified duration.</p>
<p>It is a model of how excess rainfall (after losses like infiltration) turns into runoff at the watershed outlet.</p>
<ul class="simple">
<li><p>“Excess” means we’ve already subtracted out losses using a loss model.</p></li>
<li><p>It helps us see how water moves from where it falls to where it exits—this is called time redistribution.</p></li>
</ul>
<p>You can simply think of it as a response function that turns rainfall into runoff.</p>
<p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/3-Readings/ShermanUH/Sherman_ENR_1932.pdf">L. K. Sherman (1932)</a> introduced this idea and it became a key tool in hydrology.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Once a unit hydrograph is known, it can be scaled and convolved with rainfall excess to predict runoff hydrographs for any storm, allowing flexible design under varied rainfall conditions.</p>
</div>
<div class="admonition-unit-hydrograph-concepts admonition">
<p class="admonition-title">Unit Hydrograph Concepts</p>
<p>The unit hydrograph is a response function that transforms the distributed input to the outlet, accounting for transit time to get from remote parts of the watershed to the outlet.</p>
<p><img alt="" src="../../_images/unithydrograph1.png" /></p>
<p>Another way to picture it is the stack of pizza boxes model of the watershed</p>
<p><img alt="" src="../../_images/unithydrograph2.png" /></p>
<p>The time basis matters.  In the figure below a single input of time length D produces the outlet response shown.
The unit hydrograph is the kernel function that makes the transformation.</p>
<p><img alt="" src="../../_images/unithydrograph3.png" /></p>
<p>Unit hydrograph models contain a few common themes, first input hyetograph, then a loss model which are combined to produce the excess precipitation signal</p>
<p><img alt="" src="../../_images/unithydrograph4.png" /></p>
<p>The excess precipitation signal has the same total volume as the direct ruoff</p>
<p><img alt="" src="../../_images/unithydrograph5.png" /></p>
<p>And the unit hydrograph as a transfer function maps the excess hyetograph to the outlet</p>
<p><img alt="" src="../../_images/unithydrograph6.png" /></p>
<p>The storm induced flow is added to any baseflow to produce the total hydrograph.</p>
<p><img alt="" src="../../_images/unithydrograph7.png" /></p>
</div>
<section id="principal-unit-hydrograph-assumptions">
<h2>Principal Unit Hydrograph Assumptions<a class="headerlink" href="#principal-unit-hydrograph-assumptions" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Direct runoff duration is the same for all uniform-intensity storms of the same duration:</p></li>
</ol>
<p><img alt="" src="../../_images/unitgraph1.png" /></p>
<blockquote>
<div><ul class="simple">
<li><p>If two storms both last, say, 2 hours and have uniform rainfall intensity (rain falls at a constant rate), the resulting direct runoff hydrograph (i.e., the storm response at the outlet) will cover the same time window.</p></li>
<li><p>Even if one storm drops 1 cm and another drops 2 cm, their runoff hydrographs will start and end at the same times.</p></li>
<li><p>The reason is that the unit hydrograph depends on how long the rainfall lasts, not how much falls.</p></li>
<li><p>So, duration of the direct runoff response is determined solely by the duration of the excess precipitation, not its depth.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Two excess hyetographs of the same duration will produce direct runoff hydrographs of the same duration but different magnitudes
This reflects linearity of the unit hydrograph system:</p></li>
</ol>
<p><img alt="" src="../../_images/unitgraph2.png" /></p>
<blockquote>
<div><ul class="simple">
<li><p>Imagine two storms that each last 3 hours, but one storm has 1 cm excess rainfall, and the other has 2 cm.</p></li>
<li><p>The shape and time span of the resulting hydrographs are the same.</p></li>
<li><p>But the runoff flow rates (ordinates of the hydrograph) will be scaled proportionally to the volume (or depth) of the excess rainfall.</p></li>
<li><p>For instance, if the first storm produces a peak of 10 m³/s, the second will produce a peak of 20 m³/s.</p></li>
<li><p>The <strong>runoff</strong> hydrograph is directly <strong>proportional</strong> to the volume of <strong>excess rainfall</strong>, but its duration and shape in time stay the same.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>The time distribution of direct runoff is independent of prior storms (no memory).  This assumption reflects the principle of superposition and linearity:</p></li>
</ol>
<p><img alt="" src="../../_images/unitgraph3.png" /></p>
<blockquote>
<div><ul class="simple">
<li><p>The watershed responds only to the current excess precipitation—there is no “memory” of what happened before.</p></li>
<li><p>So if you have a new storm today, the runoff it creates depends only on today’s excess rainfall, not on whether it also rained yesterday.</p></li>
<li><p>This is true as long as the watershed is assumed to be linear and time-invariant, which is a key assumption in unit hydrograph theory.</p></li>
<li><p>In reality, soils and storage might retain some effects, but for unit hydrograph models, past rainfall doesn’t affect current response.</p></li>
<li><p>The watershed behaves like a memoryless system in unit hydrograph theory: the runoff at any time is determined only by current and recent rainfall, not rainfall from previous, far back in time, unrelated events.</p></li>
</ul>
</div></blockquote>
<section id="timing">
<h3>Timing<a class="headerlink" href="#timing" title="Link to this heading">#</a></h3>
<p>Strictly speaking, each unit hydrograph has a particular duration associated with it, D in the diagram</p>
<p><img alt="" src="../../_images/unithydrograph3.png" /></p>
<ul class="simple">
<li><p>That duration must coincide with the time step size used in discrete aggregation</p></li>
<li><p>Thus a D-hour unit hydrograph is a response to a D-hour “pulse” of excess precipitation.</p></li>
</ul>
<p>The flow associated with that response is reported every D-hours until there is no further response
(<span class="math notranslate nohighlight">\(T_D\)</span> in the diagram)</p>
<p>Each watershed has a characteristic response time, <span class="math notranslate nohighlight">\(T_{lag}\)</span> and <span class="math notranslate nohighlight">\(T_P\)</span> in the diagram.
The characteristic time of the watershed is related to physical characteristics of the watershed contributing area, slope, etc.
The time step size for aggregation must the same as the duration, and the time-to-peak for the watershed must be an integer multiple of that value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These requirements are coded into HEC-HMS which will issue warnings as these requirements are violated.  As a designer you need to decide whether to ignore the warnings and proceede or adjust inputs and parameters to satisfy the various rules of the signal processing.</p>
<p>If you are using SWMM, there is less warning structure - using UH in SWMM is fine; but the user must be able to detect failed input reqirements themselves - there is no internal checking pre-se (SWMM is a hydraulics model, that approximates hydrology whereas HMS is a hydrologic model that can do some simplified hydraulics)</p>
</div>
</section>
<section id="the-unit-hydrograph-as-a-convolution-kernel">
<h3>The Unit Hydrograph as a Convolution Kernel<a class="headerlink" href="#the-unit-hydrograph-as-a-convolution-kernel" title="Link to this heading">#</a></h3>
<p>The unit hydrograph (UH) acts as a kernel function in a convolution integral, transforming excess rainfall distributed over time into direct runoff at the watershed outlet.</p>
<section id="continuous-formulation">
<h4>Continuous Formulation<a class="headerlink" href="#continuous-formulation" title="Link to this heading">#</a></h4>
<p>In continuous time, the transformation from rainfall to runoff is expressed as:</p>
<div class="math notranslate nohighlight">
\[Q(t)=A \int_0^T{r(\tau)f(t-\tau)d\tau}\]</div>
<p>Here:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q(t)\)</span> is the direct runoff rate at time</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the drainage area,</p></li>
<li><p><span class="math notranslate nohighlight">\(r(τ)\)</span> is the excess rainfall rate at past time</p></li>
<li><p><span class="math notranslate nohighlight">\(f(t−τ)\)</span> is the unit hydrograph kernel, which describes how rainfall occurring at time <span class="math notranslate nohighlight">\(𝜏\)</span> contributes to runoff at later time <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
</ul>
<p>The kernel redistributes rainfall over time, incorporating travel time delays from all points in the watershed to the outlet. In the continuous form, the UH kernel is usually normalized, meaning it integrates to 1. That way, runoff units match rainfall depth units, and the area <span class="math notranslate nohighlight">\(A\)</span> scales the total runoff volume.</p>
</section>
<section id="discrete-formulation">
<h4>Discrete Formulation<a class="headerlink" href="#discrete-formulation" title="Link to this heading">#</a></h4>
<p>In practical hydrologic modeling, rainfall and runoff are measured in time steps. The discrete form of the convolution becomes:</p>
<div class="math notranslate nohighlight">
\[Q(t)=\sum_{m=1}^{n&lt;=M}{P_m U_{n-m}}\]</div>
<p>In the above,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q_n\)</span> is the direct runoff at time step <span class="math notranslate nohighlight">\(n\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(P_m\)</span> is the excess precipitation depth at time step <span class="math notranslate nohighlight">\(m\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(U_{n-m}\)</span> is the unit hydrograph ordinate, indicating how much runoff occurs at time <span class="math notranslate nohighlight">\(n\)</span> due to rainfall at time <span class="math notranslate nohighlight">\(m\)</span>.</p></li>
</ul>
<p>This formulation assumes:</p>
<ul class="simple">
<li><p>Time is broken into equal intervals,</p></li>
<li><p>Rainfall at each time step contributes to future runoff according to the weights of the UH.</p></li>
</ul>
<p>In the discrete case, the area of the watershed is embedded in the UH ordinates. This means that rainfall is in depth units (e.g., mm or inches), and runoff are in flow units (e.g., CFS or CMS) , and the UH itself gives direct runoff rate per unit excess rainfall.</p>
<p>The convolution approach reflects two key assumptions of the unit hydrograph theory:</p>
<ul class="simple">
<li><p>Linearity: Doubling the rainfall doubles the runoff.</p></li>
<li><p>Time invariance: The watershed responds the same way to rainfall regardless of when it occurs.</p></li>
</ul>
<p>Together, these allow us to superimpose the effects of multiple rainfall inputs and predict runoff using past input data, efficiently and with reasonable accuracy.</p>
<p><img alt="" src="../../_images/convolution1.png" /></p>
</section>
</section>
</section>
<section id="synthetic-vs-observed-unit-hydrographs">
<h2>Synthetic vs. Observed Unit Hydrographs<a class="headerlink" href="#synthetic-vs-observed-unit-hydrographs" title="Link to this heading">#</a></h2>
<p>Unit hydrographs can be derived in two principal ways:</p>
<section id="observed-unit-hydrographs">
<h3>Observed Unit Hydrographs<a class="headerlink" href="#observed-unit-hydrographs" title="Link to this heading">#</a></h3>
<p>These are generated from real rainfall-runoff events in gauged watersheds. They reflect the unique topography, land use, and hydrologic response of the basin.</p>
<p>Advantages:</p>
<ul class="simple">
<li><p>Highly accurate for the basin where they’re developed</p></li>
<li><p>Reflects actual watershed behavior</p></li>
</ul>
<p>Limitations:</p>
<ul class="simple">
<li><p>Requires extensive rainfall and flow records</p></li>
<li><p>Difficult to generalize to other locations</p></li>
</ul>
</section>
<section id="building-a-unit-hydrograph-from-observations">
<h3>Building a Unit Hydrograph from Observations<a class="headerlink" href="#building-a-unit-hydrograph-from-observations" title="Link to this heading">#</a></h3>
<p>Several methods can be used to derive a unit hydrograph from observed rainfall-runoff data. Each approach attempts to solve a system that relates known rainfall inputs (excess hyetograph) to observed direct runoff at the outlet.</p>
<section id="back-substitution">
<h4>Back-Substitution<a class="headerlink" href="#back-substitution" title="Link to this heading">#</a></h4>
<p><img alt="" src="../../_images/convolution2.png" /></p>
<p><img alt="" src="../../_images/convolution3.png" /></p>
<p><img alt="" src="../../_images/convolution4.png" /></p>
<p><img alt="" src="../../_images/convolution5.png" /></p>
<p>In this approach, we use the discrete convolution equation and known data to back out the unit hydrograph ordinates:</p>
<ul class="simple">
<li><p>If the linear system is square (same number of equations as unknowns), full-rank, and has a non-zero diagonal, then the unit hydrograph ordinates can be solved using direct methods.</p></li>
<li><p>This is often better than manual back-substitution, which is error-prone and tedious.</p></li>
<li><p>In many real-world cases, the system is over-determined—meaning there are more equations than unknowns. In such cases, a simple solution may not exist, and an optimization method is required.</p></li>
</ul>
<p><img alt="" src="../../_images/convolution6.png" /></p>
</section>
<section id="least-squares">
<h4>Least-Squares<a class="headerlink" href="#least-squares" title="Link to this heading">#</a></h4>
<p>This method is well-suited to over-determined systems.</p>
<p><img alt="" src="../../_images/leastsquares.png" /></p>
<p>It finds the best-fit unit hydrograph that minimizes the squared error between observed and predicted runoff:</p>
<ul class="simple">
<li><p>May occasionally produce negative weights, especially for later times where data is sparse or noisy.</p></li>
<li><p>These negative values are typically small and occur late in the hydrograph; while not ideal, they can often be corrected or constrained in post-processing.</p></li>
<li><p>The least squares method treats the problem like a regression problem, using rainfall inputs as predictors and runoff outputs as the response.</p></li>
<li><p>It is easy to implement in a spreadsheet for small-to-moderate datasets.</p></li>
</ul>
<p><img alt="" src="../../_images/leastsquaresSS.png" /></p>
</section>
<section id="linear-programming">
<h4>Linear Programming<a class="headerlink" href="#linear-programming" title="Link to this heading">#</a></h4>
<p>Linear programming methods can enforce constraints (e.g., non-negative weights), making them more robust in some situations. These methods are beyond the scope of this course, but are referenced in assigned readings for students who wish to explore further.</p>
</section>
</section>
</section>
<section id="what-are-unit-hydrographs-used-for">
<h2>What are Unit Hydrographs used for?<a class="headerlink" href="#what-are-unit-hydrographs-used-for" title="Link to this heading">#</a></h2>
<p>Unit hydrographs are valuable tools in hydrology for predicting runoff from future storms, especially when we can reasonably assume the watershed responds linearly and consistently over time.</p>
<p>Their primary use is to estimate the direct runoff hydrograph at the watershed outlet, based on an expected excess rainfall hyetograph of known duration.</p>
<p>If a new storm is expected to last the same duration as the unit hydrograph (e.g., 3 hours), we can use scaling and superposition to predict runoff:</p>
<ul class="simple">
<li><p>Multiply the unit hydrograph by the magnitude (depth) of excess rainfall.</p></li>
<li><p>Shift and add the scaled versions to match the timing of the new rainfall pattern.</p></li>
<li><p>This allows us to predict runoff without having to rerun a full physical model of the watershed.</p></li>
</ul>
<p>If the new storm has the same shape (uniform intensity), but a different depth, we scale the unit hydrograph proportionally.</p>
<ul class="simple">
<li><p>For example, 2 cm of excess rainfall produces twice the runoff of a 1 cm storm.</p></li>
<li><p>The shape and timing of the hydrograph remain the same.</p></li>
</ul>
<p>If the new storm lasts the same amount of time but has uneven rainfall distribution across the duration, we break it into increments:</p>
<ul class="simple">
<li><p>Apply the unit hydrograph to each time step of the excess hyetograph.</p></li>
<li><p>Use discrete convolution to sum the resulting shifted hydrographs.</p></li>
<li><p>The result is a new hydrograph reflecting the storm’s unique rainfall pattern.</p></li>
</ul>
<p>Some illustrative examples using the UH just determined above</p>
<p><img alt="" src="../../_images/UHuse1.png" /></p>
<p><img alt="" src="../../_images/UHuse2.png" /></p>
<p><img alt="" src="../../_images/UHuse3.png" /></p>
<p><img alt="" src="../../_images/UHuse4.png" /></p>
<p>Unit hydrographs are most useful when:</p>
<ul class="simple">
<li><p>The storm duration matches the UH duration,</p></li>
<li><p>Watershed behavior is assumed linear and time-invariant,</p></li>
<li><p>We want a quick, practical method to estimate direct runoff without complex modeling.</p></li>
</ul>
<p>They are widely employed in design storms, flood estimation, and runoff forecasting.</p>
<section id="parametric-unit-hydrographs">
<h3>Parametric Unit Hydrographs<a class="headerlink" href="#parametric-unit-hydrographs" title="Link to this heading">#</a></h3>
<p>Instead of using a table of discrete unit hydrograph weights, we can represent the unit hydrograph as a mathematical function whose shape is controlled by one or more parameters. These are called parametric unit hydrographs.</p>
<p><img alt="" src="../../_images/parametricUH1.png" /></p>
<p><img alt="" src="../../_images/parametricUH2.png" /></p>
<p><img alt="" src="../../_images/parametricUH3.png" /></p>
<p>Parametric unit hydrographs retain the same purpose—mapping excess rainfall to direct runoff—but offer greater flexibility and compactness by reducing the number of variables to a few key shape-controlling parameters.</p>
<section id="why-use-parametric-unit-hydrographs">
<h4>Why Use Parametric Unit Hydrographs?<a class="headerlink" href="#why-use-parametric-unit-hydrographs" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Fewer values to store, interpret, or manipulate.</p></li>
<li><p>Easy to scale or extend to longer or shorter storm durations.</p></li>
<li><p>When parameters are tied to physical watershed characteristics (such as slope, channel length, soil type, or shape), the result is a synthetic unit hydrograph.</p></li>
</ul>
</section>
<section id="what-is-a-synthetic-unit-hydrograph">
<h4>What is a Synthetic Unit Hydrograph?<a class="headerlink" href="#what-is-a-synthetic-unit-hydrograph" title="Link to this heading">#</a></h4>
<p>A synthetic unit hydrograph estimates runoff behavior without observed rainfall-runoff data. Instead, it is built by relating hydrograph shape parameters to measurable watershed properties:</p>
<ul class="simple">
<li><p>Average slope</p></li>
<li><p>Length of main channel</p></li>
<li><p>Drainage area</p></li>
<li><p>Land use or soil group</p></li>
</ul>
<p>This makes synthetic methods particularly useful for ungauged watersheds or planning studies where measured runoff data are unavailable.</p>
<p><img alt="" src="../../_images/parametricUH4.png" /></p>
</section>
<section id="extending-the-time-base">
<h4>Extending the Time Base<a class="headerlink" href="#extending-the-time-base" title="Link to this heading">#</a></h4>
<p>When the storm duration is much longer than the original UH duration, the unit hydrograph must be extended in time.</p>
<p>For parametric unit hydrographs, this is relatively simple—just evaluate the function over a longer time interval and adjust accordingly.</p>
<p><img alt="" src="../../_images/timebase1.png" /></p>
<p><img alt="" src="../../_images/timebase2.png" /></p>
<p>For classically derived unit hydrographs (based on discrete weights from observed events), the S-curve method is commonly used to extend the time base. This involves cumulative summation and shifting techniques to build longer-duration responses.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In practice, most hydrologic modeling software includes built-in parametric UH options—so modern workflows rarely require manual extension unless you’re working with historical or custom unit hydrographs.</p>
</div>
</section>
</section>
<section id="synthetic-unit-hydrographs">
<h3>Synthetic Unit Hydrographs<a class="headerlink" href="#synthetic-unit-hydrographs" title="Link to this heading">#</a></h3>
<p>When direct streamflow data is unavailable, unit hydrographs can be estimated—or synthesized—using relationships that depend on measurable watershed characteristics such as:</p>
<ul class="simple">
<li><p>Drainage area</p></li>
<li><p>Average slope</p></li>
<li><p>Main stream/channel length</p></li>
<li><p>Time of concentration (or other characteristic time derived from a map)</p></li>
</ul>
<p>These methods are designed to provide reasonable approximations of watershed response, especially when field data is limited or nonexistent.</p>
<p>Common methods include:</p>
<ul class="simple">
<li><p>Snyder’s Method</p></li>
<li><p>SCS Dimensionless Unit Hydrograph (DUH)</p></li>
<li><p>Clark Method</p></li>
<li><p>USGS Regional Regression Models</p></li>
</ul>
<p><strong>Advantages</strong></p>
<ul class="simple">
<li><p>Necessary for ungauged watersheds (or a physics-based model)</p></li>
<li><p>Easily applied across large regions using GIS-derived parameters</p></li>
<li><p>Enables early-stage design and planning before detailed data collection</p></li>
<li><p>Often built into hydrologic modeling tools and design manuals</p></li>
</ul>
<p><strong>Limitations</strong></p>
<ul class="simple">
<li><p>May oversimplify complex watershed behavior</p></li>
<li><p>Accuracy depends on the quality of empirical relationships</p></li>
<li><p>Less reliable than hydrographs developed from measured rainfall-runoff events</p></li>
<li><p>Assumes uniform rainfall and simplified watershed geometry</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Synthetic unit hydrographs are indispensable in regions with limited hydrologic monitoring. They allow engineers to estimate flood response and runoff volumes during planning, screening, and feasibility analysis, especially for rural or developing areas where instrumentation is sparse.</p>
</div>
</section>
</section>
<section id="modified-rational-method">
<h2>Modified Rational Method<a class="headerlink" href="#modified-rational-method" title="Link to this heading">#</a></h2>
<p>The rational method is used to estimate peak discharges for sizing drainage structures, such as storm drains and culverts. The modified rational method (MRM) is an extension of the rational method to produce simple runoff hydrographs. The MRM is often called the rational hydrograph method. Application of the MRM produces a runoff hydrograph and runoff volume in contrast to application of the rational method, which produces only a peak design discharge (Qp).</p>
<p>The hydrograph developed from application of the MRM is a special case of the unit hydrograph method and is sometimes termed the modified rational unit hydrograph (MRUH); as a unit hydrograph, the MRUH can be applied to nonuniform rainfall distributions. Furthermore, the MRUH can be used on watersheds with drainage areas in excess of the typical limit for application of the rational method. Application of the MRUH method involves two steps: (1) determination of rainfall loss using rational method concept, that is, use of the runoff coefficient, and (2) determination of the MRUH using drainage area (A) and time of concentration (Tc) as input parameters, in addition to applying the procedure of unit hydrograph convolution.</p>
<p>Tc and runoff coefficients, C, can be estimated by a variety of methods.</p>
<div class="admonition-references-on-modified-rational-method admonition">
<p class="admonition-title">References on Modified Rational Method</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/Akan_2002.pdf">A Osman Akan. 2002. Modified rational method for sizing infiltration structures. Canadian Journal of Civil Engineering. 29(4): 539-542.</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/ce-3354-webbook-2024/3-Readings/MRM_WAMA1300032h.pdf">Dhakal, N., Fang, X., Cleveland, T.G., Thompson, D.B. 2014 “Modified Rational Unit Hydrograph Method and Applications” Institute of Civil Engineers, Journal of Water Management, WATER-D-13-00032R2</a></p></li>
</ol>
</div>
</section>
<section id="modified-rational-method-hydrograph-generator">
<h2>Modified Rational Method Hydrograph Generator<a class="headerlink" href="#modified-rational-method-hydrograph-generator" title="Link to this heading">#</a></h2>
<p>This script performs discrete convolution to generate a direct runoff hydrograph from a hyetograph for a drainage area using the modified rational method unit-hydrograph approach (cite).</p>
<p>The direct runoff hydrograph is computed using a convolution integral:</p>
<div class="math notranslate nohighlight">
\[ Q(t) = \int_{0}^{\tau}{p(t)u(t-\tau)d\tau} \]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p(t)\)</span> is the excess rainfall hyetograph</p></li>
<li><p><span class="math notranslate nohighlight">\(u(t)\)</span> is the drainage area response kernel (a unit hydrograph)</p></li>
<li><p><span class="math notranslate nohighlight">\(Q(t)\)</span> is the direct runoff hydrograph</p></li>
</ul>
<p>The response kernel for the modified rational method is</p>
<div class="math notranslate nohighlight">
\[ u(t) = \frac{A}{T_c}~\text{for}~t \le T_c\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the contributing drainage area</p></li>
<li><p><span class="math notranslate nohighlight">\(T_c\)</span> is the time of concentration</p></li>
</ul>
<p>The excess rainfall hyetograph is obtained from the precipitation input signal as</p>
<div class="math notranslate nohighlight">
\[ p(t)=C \times P(t) \]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C\)</span> is the rational equation runoff coefficient</p></li>
<li><p><span class="math notranslate nohighlight">\(P(t)\)</span> is a rainfall hyetograph (design storm)</p></li>
</ul>
<p>The example script below illustrates the calculations for an NRCS Type 2 design storm, the other design storms are included and a simple change in storm type in the <code class="docutils literal notranslate"><span class="pre">interp1d(minutes,</span> <span class="pre">type2,</span> <span class="pre">kind='linear')</span></code> function call (i.e. change type2 to another type in the program). Alternatively the analyst could supply any hyetograph they choose, but would have to fuss a bit with the array lengths.</p>
<p>The script has several prototype functions:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Convolve</span></code> is the discrete convolution integrator <br>
<code class="docutils literal notranslate"><span class="pre">kernel</span></code> is the <span class="math notranslate nohighlight">\(u(t)\)</span> kernel function above <br>
<code class="docutils literal notranslate"><span class="pre">ModRat</span></code> is the function that actually computes the time-shifted response kernel, scales inputs and outputs to produce dimensional outputs</p>
</div></blockquote>
<p>After these prototype functions is a block that generates an input excess rainfall hyetograph. The next block is the input block, the actual function call to <code class="docutils literal notranslate"><span class="pre">ModRat</span></code>, some mass balance summary calculations.
Finally the plotting section prepares graphical output, reports the inputs, summary values in the chart title, and then charts the input hyetograph (an excess hyetograph, losses are already removed), and the direct runoff hydrograph.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Input Parameters</span>
<span class="n">PT</span> <span class="o">=</span> <span class="mf">6.96</span>  <span class="c1"># Total storm depth in inches</span>
<span class="n">area</span> <span class="o">=</span> <span class="mi">181</span>  <span class="c1"># Drainage area in acres</span>
<span class="n">C</span> <span class="o">=</span> <span class="mf">0.65</span>  <span class="c1"># Runoff coefficient</span>
<span class="n">Tc</span> <span class="o">=</span> <span class="mi">45</span>  <span class="c1"># Time of concentration in minutes</span>
<span class="n">hyetType</span> <span class="o">=</span> <span class="s1">&#39;type2&#39;</span>  <span class="c1"># Options: &#39;type1&#39;, &#39;type1A&#39;, &#39;type2&#39;, &#39;type3&#39;, &#39;user&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_hyetograph</span><span class="p">(</span><span class="n">hyetType</span><span class="p">,</span> <span class="n">PT</span><span class="p">):</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mf">8.5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mf">9.5</span><span class="p">,</span><span class="mf">9.75</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">10.5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mf">11.5</span><span class="p">,</span><span class="mf">11.75</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mf">12.5</span><span class="p">,</span><span class="mf">13.0</span><span class="p">,</span><span class="mf">13.6</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">48</span><span class="p">]</span>
    <span class="n">minutes</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">60</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">hour</span><span class="p">]</span>
    <span class="n">hyets</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;type1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.035</span><span class="p">,</span><span class="mf">0.076</span><span class="p">,</span><span class="mf">0.125</span><span class="p">,</span><span class="mf">0.156</span><span class="p">,</span><span class="mf">0.194</span><span class="p">,</span><span class="mf">0.219</span><span class="p">,</span><span class="mf">0.254</span><span class="p">,</span><span class="mf">0.303</span><span class="p">,</span><span class="mf">0.362</span><span class="p">,</span><span class="mf">0.515</span><span class="p">,</span><span class="mf">0.583</span><span class="p">,</span><span class="mf">0.624</span><span class="p">,</span><span class="mf">0.654</span><span class="p">,</span><span class="mf">0.669</span><span class="p">,</span><span class="mf">0.682</span><span class="p">,</span><span class="mf">0.706</span><span class="p">,</span><span class="mf">0.727</span><span class="p">,</span><span class="mf">0.748</span><span class="p">,</span><span class="mf">0.767</span><span class="p">,</span><span class="mf">0.83</span><span class="p">,</span><span class="mf">0.926</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;type1A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.116</span><span class="p">,</span><span class="mf">0.206</span><span class="p">,</span><span class="mf">0.268</span><span class="p">,</span><span class="mf">0.425</span><span class="p">,</span><span class="mf">0.48</span><span class="p">,</span><span class="mf">0.52</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.564</span><span class="p">,</span><span class="mf">0.577</span><span class="p">,</span><span class="mf">0.601</span><span class="p">,</span><span class="mf">0.624</span><span class="p">,</span><span class="mf">0.645</span><span class="p">,</span><span class="mf">0.655</span><span class="p">,</span><span class="mf">0.664</span><span class="p">,</span><span class="mf">0.683</span><span class="p">,</span><span class="mf">0.701</span><span class="p">,</span><span class="mf">0.719</span><span class="p">,</span><span class="mf">0.736</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.906</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;type2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.022</span><span class="p">,</span><span class="mf">0.048</span><span class="p">,</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.098</span><span class="p">,</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.133</span><span class="p">,</span><span class="mf">0.147</span><span class="p">,</span><span class="mf">0.163</span><span class="p">,</span><span class="mf">0.172</span><span class="p">,</span><span class="mf">0.181</span><span class="p">,</span><span class="mf">0.204</span><span class="p">,</span><span class="mf">0.235</span><span class="p">,</span><span class="mf">0.283</span><span class="p">,</span><span class="mf">0.357</span><span class="p">,</span><span class="mf">0.663</span><span class="p">,</span><span class="mf">0.735</span><span class="p">,</span><span class="mf">0.772</span><span class="p">,</span><span class="mf">0.799</span><span class="p">,</span><span class="mf">0.82</span><span class="p">,</span><span class="mf">0.88</span><span class="p">,</span><span class="mf">0.952</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;type3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.043</span><span class="p">,</span><span class="mf">0.072</span><span class="p">,</span><span class="mf">0.089</span><span class="p">,</span><span class="mf">0.115</span><span class="p">,</span><span class="mf">0.13</span><span class="p">,</span><span class="mf">0.148</span><span class="p">,</span><span class="mf">0.167</span><span class="p">,</span><span class="mf">0.178</span><span class="p">,</span><span class="mf">0.189</span><span class="p">,</span><span class="mf">0.216</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.298</span><span class="p">,</span><span class="mf">0.339</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.702</span><span class="p">,</span><span class="mf">0.751</span><span class="p">,</span><span class="mf">0.785</span><span class="p">,</span><span class="mf">0.811</span><span class="p">,</span><span class="mf">0.886</span><span class="p">,</span><span class="mf">0.957</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.4285</span><span class="p">,</span><span class="mf">0.8571</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># Adjust time scaling below if needed</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">hyetType</span> <span class="o">==</span> <span class="s1">&#39;user&#39;</span><span class="p">:</span>
        <span class="n">user_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mf">9.3333</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">48</span><span class="p">]</span>
        <span class="n">minutes</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">60</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">user_time</span><span class="p">]</span>
        <span class="n">hyet</span> <span class="o">=</span> <span class="n">hyets</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hyet</span> <span class="o">=</span> <span class="n">hyets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hyetType</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">minutes</span><span class="p">,</span> <span class="n">hyet</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
    <span class="n">t24</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2881</span><span class="p">)</span>  <span class="c1"># 48 hours in minutes</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="n">PT</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t24</span><span class="p">)</span>  <span class="c1"># Scaled cumulative rainfall depth</span>
    <span class="n">intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">*</span> <span class="mi">60</span>  <span class="c1"># in/hr</span>
    <span class="k">return</span> <span class="n">t24</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="n">depth</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kernel</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">Tc</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">area</span><span class="o">/</span><span class="n">Tc</span> <span class="k">if</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="n">Tc</span> <span class="k">else</span> <span class="mf">0.0</span>

<span class="k">def</span> <span class="nf">Convolve</span><span class="p">(</span><span class="n">excitation</span><span class="p">,</span> <span class="n">kernel</span><span class="p">):</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">excitation</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">duration</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">duration</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excitation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">kernel</span><span class="p">[(</span><span class="n">j</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ModRat</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">precipitation</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">Tc</span><span class="p">):</span>
    <span class="n">excess</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">precipitation</span><span class="p">)</span>
    <span class="n">unitgraph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">kernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">])</span>
    <span class="n">unitgraph</span> <span class="o">/=</span> <span class="n">unitgraph</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">flow</span> <span class="o">=</span> <span class="n">Convolve</span><span class="p">(</span><span class="n">excess</span><span class="p">,</span> <span class="n">unitgraph</span><span class="p">)</span>
    <span class="n">flow</span> <span class="o">=</span> <span class="n">area</span> <span class="o">*</span> <span class="n">flow</span>
    <span class="k">return</span> <span class="n">flow</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t24</span><span class="p">,</span> <span class="n">r24</span><span class="p">,</span> <span class="n">d24</span> <span class="o">=</span> <span class="n">get_hyetograph</span><span class="p">(</span><span class="n">hyetType</span><span class="p">,</span> <span class="n">PT</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">ModRat</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">r24</span><span class="p">,</span> <span class="n">t24</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span>

<span class="c1"># Summary values</span>
<span class="n">peakQ</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">totalQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">/</span> <span class="mi">43560</span>  <span class="c1"># cfs to acre-feet</span>
<span class="n">totalR</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">d24</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">area</span>  <span class="c1"># inches to feet to acre-feet</span>
<span class="n">massE</span> <span class="o">=</span> <span class="p">(</span><span class="n">totalR</span> <span class="o">-</span> <span class="n">totalQ</span><span class="p">)</span> <span class="o">/</span> <span class="n">totalR</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_hydrograph</span><span class="p">(</span><span class="n">t24</span><span class="p">,</span> <span class="n">r24</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">PT</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">hyetType</span><span class="p">,</span> <span class="n">peakQ</span><span class="p">,</span> <span class="n">totalQ</span><span class="p">,</span> <span class="n">totalR</span><span class="p">,</span> <span class="n">massE</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;type1&#39;</span><span class="p">:</span> <span class="s1">&#39;SCS Type 1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type1A&#39;</span><span class="p">:</span> <span class="s1">&#39;SCS Type 1A&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type2&#39;</span><span class="p">:</span> <span class="s1">&#39;SCS Type 2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type3&#39;</span><span class="p">:</span> <span class="s1">&#39;SCS Type 3&#39;</span><span class="p">,</span>
        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;User Defined&#39;</span>
    <span class="p">}</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hyetType</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>

    <span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Direct Runoff Hydrograph – Modified Rational Method</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Hyetograph Type: </span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Area: </span><span class="si">{</span><span class="n">area</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> acres | Storm Depth: </span><span class="si">{</span><span class="n">PT</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> in | C: </span><span class="si">{</span><span class="n">C</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | Tc: </span><span class="si">{</span><span class="n">Tc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> min</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Peak Q: </span><span class="si">{</span><span class="n">peakQ</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> cfs | Q total: </span><span class="si">{</span><span class="n">totalQ</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> af | xsR total: </span><span class="si">{</span><span class="n">totalR</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> af</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Mass Balance Error: </span><span class="si">{</span><span class="n">massE</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">t24</span><span class="p">,</span> <span class="n">r24</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rainfall Intensity (in/hr)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Rainfall Intensity (in/hr)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (minutes)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">t24</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Runoff Discharge (cfs)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Runoff Discharge (cfs)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The code block below actually performs the simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hydrograph</span><span class="p">(</span><span class="n">t24</span><span class="p">,</span> <span class="n">r24</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">PT</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">hyetType</span><span class="p">,</span> <span class="n">peakQ</span><span class="p">,</span> <span class="n">totalQ</span><span class="p">,</span> <span class="n">totalR</span><span class="p">,</span> <span class="n">massE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2da89909b3199785bc34ce57e2b10ca4ae2aba8353ff8c0a0ab0e91e359965d7.png" src="../../_images/2da89909b3199785bc34ce57e2b10ca4ae2aba8353ff8c0a0ab0e91e359965d7.png" />
</div>
</div>
</section>
<section id="exercise-s">
<h2>Exercise(s)<a class="headerlink" href="#exercise-s" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="http://54.243.252.9/ce-3354-webroot/hydrohandbook/exercises/05-rainfallrunoff/ce3354-es5-2025-2.pdf"><strong>ce3354-es5-2025-2.pdf</strong></a>  Rainfall-runoff using modified rational and unit hydrograph methods</p>
</section>
<section id="section-end">
<h2>Section End<a class="headerlink" href="#section-end" title="Link to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python-my-env",
            path: "./chapters/05-rainfallrunoff"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python-my-env'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../04-runoffgeneration/04-runoffgeneration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">4. Runoff Generation and Watershed Hydrology</p>
      </div>
    </a>
    <a class="right-next"
       href="../06-streamflow/06-streamflow.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">6. Streamflow Measurement and Streamflow Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">5. Rainfall-Runoff Relationships</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#readings">Readings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#videos">Videos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheets">Spreadsheets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-rational-method-background">The Rational Method - Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rational-method-in-detail">Rational Method - In Detail</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-of-concentration">Time of Concentration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-scs-curve-number-cn-method-background">The SCS Curve Number (CN) Method - Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-number-selection">Curve Number Selection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rainfall-runoff-modeling">Rainfall-Runoff Modeling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-reservoir-model">Linear Reservoir Model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nrcs-runoff-generation-models">NRCS Runoff Generation Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-nrcs-cn-as-a-linear-reservoir-model">Interpretation of NRCS CN as a linear reservoir model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concept-of-hydrograph-peak-s-and-baseflow">Concept of Hydrograph, Peak(s), and Baseflow</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-hydrographs">5.1 Unit Hydrographs</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-unit-hydrograph-assumptions">Principal Unit Hydrograph Assumptions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timing">Timing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-unit-hydrograph-as-a-convolution-kernel">The Unit Hydrograph as a Convolution Kernel</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-formulation">Continuous Formulation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discrete-formulation">Discrete Formulation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#synthetic-vs-observed-unit-hydrographs">Synthetic vs. Observed Unit Hydrographs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observed-unit-hydrographs">Observed Unit Hydrographs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-unit-hydrograph-from-observations">Building a Unit Hydrograph from Observations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#back-substitution">Back-Substitution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares">Least-Squares</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-programming">Linear Programming</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-unit-hydrographs-used-for">What are Unit Hydrographs used for?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-unit-hydrographs">Parametric Unit Hydrographs</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-parametric-unit-hydrographs">Why Use Parametric Unit Hydrographs?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-synthetic-unit-hydrograph">What is a Synthetic Unit Hydrograph?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extending-the-time-base">Extending the Time Base</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synthetic-unit-hydrographs">Synthetic Unit Hydrographs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modified-rational-method">Modified Rational Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modified-rational-method-hydrograph-generator">Modified Rational Method Hydrograph Generator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-s">Exercise(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-end">Section End</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Theodore G. Cleveland, Ph.D., P.E., M.ASCE, F.EWRI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>